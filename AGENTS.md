# Repository Guidelines

## Project Structure & Module Organization
Project root organizes the Move package with `Move.toml` controlling addresses. Core module lives in `sources/sui_gacha.move`, exposing entry functions for creating, toggling, and drawing from a shared `Gacha`. Deterministic helpers and property-style tests reside in `tests/sui_gacha_tests.move`. The `build/` directory is generated by `sui move build`; treat it as ephemeral. Keep `README.md` aligned with any public API shifts.

## Build, Test, and Development Commands
- `sui move build` – type-checks the package and refreshes `build/`.
- `sui move test` – runs the Move unit tests under `tests/`.
- `sui move test --filter <name>` – scope to a single test when iterating.
Run commands from repo root with an up-to-date Sui CLI (v1.20+).

## Coding Style & Naming Conventions
Follow Sui Move conventions: four-space indentation, snake_case functions, CamelCase structs, and uppercase error codes. Keep abort codes centralised near the top of the module and document public entry points with inline comments. Format code with `sui move fmt sources/ tests/` before sending a PR. Module names stay under the `sui_gacha::` address; avoid introducing additional packages unless justified.

## Testing Guidelines
Use the existing unit suite in `tests/sui_gacha_tests.move` as the template. New behaviours should include positive coverage plus `#[expected_failure(...)]` checks for abort paths. Prefer deterministic index vectors when extending the simulators so failures reproduce easily. If tests cover new helper functions, expose them under `#[test_only]` wrappers and verify totals, tiers, and sparse-map invariants.

## Commit & Pull Request Guidelines
History currently uses short, present-tense subjects with optional gitmoji prefixes (e.g., `:tada: init repo`). Keep subjects under 72 characters and describe the behaviour change first. For pull requests, include: 1) a concise summary of the user-facing effect, 2) mention of any new entry functions or storage layout shifts, and 3) test evidence (`sui move test` output or a failing reproduction). Link issues when available and attach screenshots only if UI tools are involved.

## Security & Configuration Notes
Random draws rely on `sui::random` and the per-call generator; do not refactor the entry path to bypass `&Random`. Guard any new admin operations behind the existing `AdminCap` checks and prefer abort codes over silent no-ops. When adding storage fields, update migration guidance in `README.md` and confirm `set_active` and `draw` remain constant-cost.
